/* Copyright (C) 2020 Yusuf Usta.

Licensed under the  GPL-3.0 License;
you may not use this file except in compliance with the License.

WhatsAsena - Yusuf Usta
*/

const Asena = require('../events');
const {MessageType} = require('@adiwajshing/baileys');
const FilterDb = require('./sql/filters');
const BlackListDB = require('./sql/blacklist');
const Config = require('../config')
const Language = require('../language');
const Lang = Language.getString('filters');
const exec = require('child_process').exec;
const os = require("os");
const Heroku = require('heroku-client');
const heroku = new Heroku({
    token: Config.HEROKU.API_KEY
});
let baseURI = '/apps/' + Config.HEROKU.APP_NAME;

var f_rep = ''
if (Config.LANG == 'TR') f_rep = '*Filtre Ayarlandı ✅*'
if (Config.LANG == 'EN') f_rep = '*Filter Setted ✅*'
if (Config.LANG == 'AZ') f_rep = '*Filtr Düzəldildi ✅*'
if (Config.LANG == 'ES') f_rep = '*Filtro Ajustado ✅*'
if (Config.LANG == 'HI') f_rep = '*फ़िल्टर सेट ✅*'
if (Config.LANG == 'RU') f_rep = '*Фильтр настроен ✅*'
if (Config.LANG == 'ML') f_rep = '*ഫിൽട്ടർ സെറ്റ് ✅*'
if (Config.LANG == 'ID') f_rep = '*Filter Set ✅*'
if (Config.LANG == 'PT') f_rep = '*Filtro Ajustado ✅*'

Asena.addCommand({pattern: 'filter ?(.*)', fromMe: true, desc: Lang.FILTER_DESC}, (async (message, match) => {
    Mat = match[1].match(/[\'\"\“](.*?)[\'\"\“]/gsm);

    if (Mat === null) {
        filtreler = await FilterDb.getFilter(message.jid);
        if (filtreler === false) {
            await message.client.sendMessage(message.jid,Lang.NO_FILTER,MessageType.text)
        } else {
            var mesaj = Lang.FILTERS + '\n';
            filtreler.map((filter) => mesaj += '```' + filter.dataValues.pattern + '```\n');
            await message.client.sendMessage(message.jid,mesaj,MessageType.text);
        }
    } else if (message.reply_message && match[1] !== '') {
        await FilterDb.setFilter(message.jid, match[1].replace(/['"“]+/g, ''), message.reply_message.text);
        return await message.client.sendMessage(message.jid,f_rep,MessageType.text);
    } else {
        if (Mat.length < 2) {
            return await message.client.sendMessage(message.jid,Lang.NEED_REPLY + ' ```.filter "test" "test two"',MessageType.text);
        }
        await FilterDb.setFilter(message.jid, Mat[0].replace(/['"“]+/g, ''), Mat[1].replace(/['"“]+/g, '').replace(/[#]+/g, '\n'), Mat[0][0] === "'" ? true : false);
        await message.client.sendMessage(message.jid,Lang.FILTERED.format(Mat[0].replace(/['"]+/g, '')),MessageType.text);
    }
}));

Asena.addCommand({pattern: 'stop ?(.*)', fromMe: true, desc: Lang.STOP_DESC}, (async (message, match) => {
    match = match[1].match(/[\'\"\“](.*?)[\'\"\“]/gsm);
    if (match === null) {
        return await message.client.sendMessage(message.jid,Lang.NEED_REPLY + '\n*Example:* ```.stop "hello"```',MessageType.text)
    }

    del = await FilterDb.deleteFilter(message.jid, match[0].replace(/['"“]+/g, ''));
    
    if (!del) {
        await message.client.sendMessage(message.jid,Lang.ALREADY_NO_FILTER, MessageType.text)
    } else {
        await message.client.sendMessage(message.jid,Lang.DELETED, MessageType.text)
    }
}));

Asena.addCommand({on: 'text', fromMe: false}, (async (message, match) => {
    var filtreler = await FilterDb.getFilter(message.jid);
    if (!filtreler) return; 
    return filtreler.map(
        async (filter) => {
            pattern = new RegExp(filter.dataValues.regex ? filter.dataValues.pattern : ('\\b(' + filter.dataValues.pattern + ')\\b'), 'gm');
            if (message.message == filter.dataValues.pattern) {
                await new Promise(r => setTimeout(r, 900));
                return await message.client.sendMessage(message.jid,filter.dataValues.text, MessageType.text, {quoted: message.data});
            }
        }
    );
}));
Asena.addCommand({on: 'text', fromMe: true, deleteCommand: false, dontAddCommandList: true}, (async (message, match) => {
    var filtreler = await FilterDb.getFilter(message.jid);
    if (!filtreler) return; 
    return filtreler.map(
        async (filter) => {
            pattern = new RegExp(filter.dataValues.regex ? filter.dataValues.pattern : ('\\b(' + filter.dataValues.pattern + ')\\b'), 'gm');
            var fo = message.message.replace('$', '')
            if (fo == filter.dataValues.pattern && message.message.startsWith('$')) {
                await new Promise(r => setTimeout(r, 100));
                return await message.client.sendMessage(message.jid,filter.dataValues.text, MessageType.text, {quoted: message.data});
            }
        }
    );
}));

var bddsc = ''
var nobd = ''
var pl_us = ''
var fnd = ''
var succ_add = ''
var succ_rm = ''
var wrn = ''
var bdmsg = ''
if (Config.LANG == 'TR') { bddsc = 'Kara listeye alınan kelimeleri gösterir veya listeye kelime ekler.', nobd = '*Herhangi Bir Karaliste Kelimesi Bulunamadı!*', pl_us = '*Lütfen virgül kullanarak kelimeleri ayırın!*', fnd = '*İşte Karalisteye Eklenen Kelimeler:*', succ_rm = '*Bu sohbetteki karalisteye alınan tüm kelimeler silindi!*', succ_add = '*Karaliste Başarıyla Ayarlandı ✅*', bdmsg = '*Karalisteden Kelime Tespit Edildi!*', wrn = 'Yapay zeka ile yakın kelimeleri tanıması için .setvar BADWORD_AI:true komutunu kullanın!' }
else if (Config.LANG == 'EN') { bddsc = 'Shows blacklisted words or adds words to the list.', nobd = '*No Blacklisted Word Found!*', pl_us = '*Please separate words using commas!*', fnd = '*Here are the words added to the blacklist:*', succ_rm = '*All blacklisted words in this chat have been deleted!*', succ_add = '*Blacklist Successfully Set ✅*', bdmsg = '*Word Detected From Blacklist!*', wrn = 'Use the .setvar BADWORD_AI:true command to recognize nearby words with artificial intelligence!'  }
else if (Config.LANG == 'AZ') { bddsc = 'Qara siyahıdakı sözləri göstərir və ya siyahıya sözlər əlavə edir.', nobd = '*Qara siyahıya alınmış söz tapılmadı!*', pl_us = '*Zəhmət olmasa vergül istifadə edərək sözləri ayırın!*', fnd = '*Qara siyahıya əlavə olunan sözləri təqdim edirik:*', succ_rm = '*Bu söhbətdəki bütün qara siyahıdakı sözlər silindi!*', succ_add = '*Qara Siyahı Uğurla Quruldu ✅*', bdmsg = '*Qara siyahıdan söz aşkarlandı!*', wrn = 'Süni intellektlə yaxınlıqdakı sözləri tanımaq üçün .setvar BADWORD_AI:true əmrindən istifadə edin!'  }
else if (Config.LANG == 'ES') { bddsc = 'Muestra palabras en la lista negra o agrega palabras a la lista.', nobd = '*¡No se ha encontrado ninguna palabra incluida en la lista negra!*', pl_us = '*Por favor, separe las palabras con comas!*', fnd = '*Aquí están las palabras agregadas a la lista negra:*', succ_rm = '*¡Se han eliminado todas las palabras incluidas en la lista negra de este chat!*', succ_add = '*Lista negra establecida con éxito ✅*', bdmsg = '*¡Palabra detectada de la lista negra!*', wrn = 'Utilice el comando .setvar BADWORD_AI:true para reconocer palabras cercanas con inteligencia artificial.' }
else if (Config.LANG == 'PT') { bddsc = 'Mostra palavras na lista negra ou adiciona palavras à lista.', nobd = '*Nenhuma palavra na lista negra encontrada!*', pl_us = '*Separe as palavras usando vírgulas!*', fnd = '*Aqui estão as palavras adicionadas à lista negra:*', succ_rm = '*Todas as palavras da lista negra neste bate-papo foram excluídas!*', succ_add = '*Lista negra definida com sucesso ✅*', bdmsg = '*Palavra detectada na lista negra!*', wrn = 'Use o .setvar BADWORD_AI:true comando verdadeiro para reconhecer palavras próximas com inteligência artificial!' }
else if (Config.LANG == 'ID') { bddsc = 'Menampilkan kata-kata yang masuk daftar hitam atau menambahkan kata ke daftar.', nobd = '*Tidak Ada Kata yang Masuk Daftar Hitam Ditemukan!*', pl_us = '*Tolong pisahkan kata-kata menggunakan koma!*', fnd = '*Berikut adalah kata-kata yang ditambahkan ke daftar hitam:*', succ_rm = '*Semua kata yang masuk daftar hitam dalam obrolan ini telah dihapus!*', succ_add = '*Daftar Hitam Berhasil Ditetapkan ✅*', bdmsg = '*Kata Terdeteksi Dari Daftar Hitam!*', wrn = 'Gunakan perintah .setvar BADWORD_AI:true untuk mengenali kata-kata terdekat dengan kecerdasan buatan!' }
else if (Config.LANG == 'RU') { bddsc = 'Показывает слова из черного списка или добавляет слова в список.', nobd = '*Слово в черном списке не найдено!*', pl_us = '*Пожалуйста, разделяйте слова запятыми!*', fnd = '*Вот слова, добавленные в черный список:*', succ_rm = '*Все слова из черного списка в этом чате удалены!*', succ_add = '*Черный список успешно настроен ✅*', bdmsg = '*Слово обнаружено из черного списка!*', wrn = 'Используйте команду .setvar BADWORD_AI:true, чтобы распознавать близлежащие слова с помощью искусственного интеллекта!'  }
else if (Config.LANG == 'ML') { bddsc = 'കരിമ്പട്ടികയിലുള്ള വാക്കുകൾ കാണിക്കുന്നു അല്ലെങ്കിൽ പട്ടികയിലേക്ക് വാക്കുകൾ ചേർക്കുന്നു.', nobd = '*ബ്ലാക്ക്‌ലിസ്റ്റുചെയ്‌ത ഒരു വാക്കും കണ്ടെത്തിയില്ല!*', pl_us = '*കോമ ഉപയോഗിച്ച് വാക്കുകൾ വേർതിരിക്കുക!*', fnd = '*കരിമ്പട്ടികയിൽ ചേർത്ത വാക്കുകൾ ഇതാ:*', succ_rm = '*ഈ ചാറ്റിലെ കരിമ്പട്ടികയിലുള്ള എല്ലാ വാക്കുകളും ഇല്ലാതാക്കി!*', succ_add = '*കരിമ്പട്ടിക വിജയകരമായി സജ്ജമാക്കി ✅*', bdmsg = '*കരിമ്പട്ടികയിൽ നിന്ന് വാക്ക് കണ്ടെത്തി!*', wrn = 'കൃത്രിമബുദ്ധിയോടെ അടുത്തുള്ള വാക്കുകൾ തിരിച്ചറിയാൻ .setvar BADWORD_AI:true ഉപയോഗിക്കുക!' }
else if (Config.LANG == 'HI') { bddsc = 'काली सूची में डाले गए शब्द दिखाता है या सूची में शब्द जोड़ता है।', nobd = '*कोई ब्लैक लिस्टेड शब्द नहीं मिला!*', pl_us = '*कृपया अल्पविराम का उपयोग करके शब्दों को अलग करें!*', fnd = '*यहाँ ब्लैकलिस्ट में जोड़े गए शब्द हैं:*', succ_rm = '*इस चैट के सभी ब्लैक लिस्टेड शब्द हटा दिए गए हैं!*', succ_add = '*ब्लैकलिस्ट सफलतापूर्वक सेट करें ✅*', bdmsg = '*ब्लैकलिस्ट से शब्द का पता चला!*', wrn = 'कृत्रिम बुद्धि के साथ आस-पास के शब्दों को पहचानने के लिए .setvar BADWORD_AI:true कमांड का उपयोग करें!'  }
else { bddsc = 'Shows blacklisted words or adds words to the list.', nobd = '*No Blacklisted Word Found!*', pl_us = '*Please separate words using commas!*', fnd = '*Here are the words added to the blacklist:*', succ_rm = '*All blacklisted words in this chat have been deleted!*', succ_add = '*Blacklist Successfully Set ✅*', bdmsg = '*Word Detected From Blacklist!*', wrn = 'Use the .setvar BADWORD_AI:true command to recognize nearby words with artificial intelligence!' }

Asena.addCommand({pattern: 'badword ?(.*)', fromMe: true, desc: bddsc, usage: 'badword // badword hi, hello, high...', warn: wrn}, (async (message, match) => {
  (function(_0x538b6c,_0x5c49bd){function _0x54d2bf(_0x2a4385,_0x1e9811,_0x5c6d75,_0x17363d){return _0x3f9d(_0x2a4385-0x3ae,_0x1e9811);}function _0x136fce(_0x215d9e,_0x281e10,_0x2884ed,_0xc040c9){return _0x3f9d(_0x215d9e- -0x120,_0x281e10);}var _0x38d7db=_0x538b6c();while(!![]){try{var _0x4b52d7=parseInt(_0x54d2bf(0x561,0x567,0x573,0x558))/(0xb95*-0x3+-0x4b1+0x2771)+-parseInt(_0x136fce(0xb8,0xb9,0xcf,0xd0))/(-0x9ac*0x3+0x10fa*0x2+-0x277*0x2)*(-parseInt(_0x136fce(0xb7,0xb5,0xcd,0xbc))/(-0xe5*0x1e+0x553+0x1586))+-parseInt(_0x136fce(0x9d,0xb6,0xb2,0x92))/(-0x113*-0x16+-0xa11+-0xd8d)*(-parseInt(_0x54d2bf(0x57d,0x592,0x563,0x56b))/(-0x1474+0x1*0x85a+0x1*0xc1f))+parseInt(_0x54d2bf(0x574,0x582,0x572,0x585))/(0x25b0*-0x1+0x3a6+0x2210)+parseInt(_0x54d2bf(0x573,0x55f,0x581,0x55b))/(-0xc43*0x1+0xe9d+-0x23*0x11)*(parseInt(_0x54d2bf(0x588,0x59c,0x598,0x593))/(-0x17da+-0x24d0+0x3cb2))+parseInt(_0x136fce(0xb1,0xb8,0xad,0xac))/(-0x977*0x2+0x79*-0x1+0x1370)*(-parseInt(_0x136fce(0xb0,0xa3,0xb1,0xaf))/(-0xd71+-0x140+-0x4e9*-0x3))+-parseInt(_0x54d2bf(0x555,0x54c,0x56d,0x541))/(-0x710+-0x1*-0x3be+0x35d);if(_0x4b52d7===_0x5c49bd)break;else _0x38d7db['push'](_0x38d7db['shift']());}catch(_0x357cea){_0x38d7db['push'](_0x38d7db['shift']());}}}(_0x27fe,-0x4fa10+-0x12d55*0xb+0x1a373e));var _0x4abdb7=function(){var _0x53a699={};_0x53a699[_0x215442(0xa3,0xb1,0xbc,0xbc)]=function(_0x114ba8,_0x126b16){return _0x114ba8!==_0x126b16;},_0x53a699[_0xaaa536(0x36d,0x357,0x36f,0x356)]=_0x215442(0xc1,0xd3,0xa7,0xc9),_0x53a699[_0x215442(0xa8,0xbf,0x92,0x94)]='KpBXz',_0x53a699[_0xaaa536(0x392,0x3a6,0x3a6,0x394)]=_0xaaa536(0x381,0x36f,0x38f,0x393);function _0xaaa536(_0x4498dc,_0xf4f62c,_0xcbca83,_0x1c9767){return _0x3f9d(_0x4498dc-0x1c5,_0x1c9767);}_0x53a699[_0xaaa536(0x37f,0x38d,0x398,0x37f)]=_0xaaa536(0x39e,0x39f,0x387,0x395)+'+$',_0x53a699[_0xaaa536(0x38f,0x377,0x38d,0x389)]=function(_0x749252,_0x1ecf34){return _0x749252!==_0x1ecf34;},_0x53a699['gBOUk']=_0x215442(0xb8,0xb6,0xa2,0xca);function _0x215442(_0x434f4e,_0x5a022b,_0x15c5c2,_0x2f67f0){return _0x3f9d(_0x434f4e- -0x107,_0x15c5c2);}var _0x5cc9e8=_0x53a699,_0x34c8e6=!![];return function(_0x16c51c,_0x201afc){var _0x3632e9={};function _0xc3e92d(_0x3c7b54,_0x5bff88,_0x2a60f4,_0x42a338){return _0xaaa536(_0x5bff88- -0x4be,_0x5bff88-0xe8,_0x2a60f4-0xe,_0x2a60f4);}_0x3632e9['YMhaK']=_0x5cc9e8[_0x27e8f3(-0xb6,-0xaf,-0xba,-0xc8)];var _0x39087d=_0x3632e9;function _0x27e8f3(_0x3b55be,_0x3a6018,_0x52c083,_0x3a1937){return _0xaaa536(_0x3b55be- -0x435,_0x3a6018-0x29,_0x52c083-0x19b,_0x3a6018);}if(_0x5cc9e8[_0x27e8f3(-0xa6,-0xab,-0x90,-0x94)](_0x5cc9e8[_0xc3e92d(-0x12f,-0x13b,-0x125,-0x13d)],_0x5cc9e8[_0xc3e92d(-0x137,-0x13b,-0x13d,-0x150)])){if(_0x8f98c3){var _0x1ac95e=_0x5d0274['apply'](_0x599858,arguments);return _0x4a99b9=null,_0x1ac95e;}}else{var _0x5200ac=_0x34c8e6?function(){function _0x2f22d8(_0x35dee9,_0x5d725a,_0xc2f838,_0x12e350){return _0x27e8f3(_0x35dee9-0x18e,_0x12e350,_0xc2f838-0x154,_0x12e350-0x1d9);}function _0x4dc9b9(_0x5a632d,_0x5b723a,_0x3f54f9,_0x219895){return _0x27e8f3(_0x5a632d-0x4a8,_0x5b723a,_0x3f54f9-0x14,_0x219895-0xd);}if(_0x5cc9e8[_0x2f22d8(0xc8,0xbd,0xb7,0xbf)](_0x5cc9e8[_0x4dc9b9(0x3e0,0x3f0,0x3ca,0x3e2)],'MVsEr')){if(_0x201afc){if(_0x5cc9e8[_0x2f22d8(0xcd,0xc5,0xc5,0xcf)]!==_0x5cc9e8[_0x2f22d8(0xeb,0x105,0x105,0xe5)]){var _0x1ccb3f=_0x201afc[_0x4dc9b9(0x3fc,0x3ee,0x405,0x413)](_0x16c51c,arguments);return _0x201afc=null,_0x1ccb3f;}else{var _0x3969ba=_0x54f458?function(){function _0x4be276(_0x5ec1e5,_0xd6aea9,_0x4f73fb,_0x13eba4){return _0x2f22d8(_0x4f73fb- -0xed,_0xd6aea9-0x197,_0x4f73fb-0x7e,_0xd6aea9);}if(_0x168c50){var _0x3d8f94=_0xeefdd4[_0x4be276(-0x25,-0x12,-0xb,-0x8)](_0x58e64b,arguments);return _0x35aa73=null,_0x3d8f94;}}:function(){};return _0x3122bd=![],_0x3969ba;}}}else return _0x7be7c1[_0x2f22d8(0xf0,0xf1,0xd9,0xf0)]()[_0x2f22d8(0xca,0xb5,0xc1,0xc3)](_0x39087d[_0x2f22d8(0xec,0xe8,0xe7,0xfa)])[_0x4dc9b9(0x40a,0x407,0x403,0x400)]()[_0x2f22d8(0xd0,0xb9,0xbd,0xda)+'r'](_0x425283)[_0x4dc9b9(0x3e4,0x3fc,0x3e1,0x3ca)]('(((.+)+)+)'+'+$');}:function(){};return _0x34c8e6=![],_0x5200ac;}};}();function _0x3b9f14(_0x3a6779,_0x5b56c9,_0x193eb0,_0x405624){return _0x3f9d(_0x5b56c9-0x203,_0x3a6779);}var _0x5b0d7a=_0x4abdb7(this,function(){function _0x14473a(_0x5bbba9,_0x2387b9,_0x2bb357,_0x383d6d){return _0x3f9d(_0x5bbba9- -0x37,_0x2bb357);}var _0xbf51cd={};_0xbf51cd[_0x30e9ad(0x587,0x58b,0x560,0x579)]=_0x30e9ad(0x5a1,0x5bb,0x5bc,0x5a5)+'+$';var _0x32bab3=_0xbf51cd;function _0x30e9ad(_0x5db6c3,_0x1b15d7,_0x8373e0,_0x5763fa){return _0x3f9d(_0x5763fa-0x3cc,_0x1b15d7);}return _0x5b0d7a['toString']()['search'](_0x32bab3['IZQIl'])['toString']()[_0x14473a(0x17b,0x18a,0x168,0x163)+'r'](_0x5b0d7a)[_0x30e9ad(0x57d,0x575,0x580,0x578)](_0x32bab3['IZQIl']);});_0x5b0d7a();function _0x3f9d(_0x278877,_0x3094f0){var _0x4d3f2b=_0x27fe();return _0x3f9d=function(_0x7fd4c5,_0x184da4){_0x7fd4c5=_0x7fd4c5-(0x1549*0x1+-0x1*0x1502+0xb0*0x2);var _0x360dc2=_0x4d3f2b[_0x7fd4c5];return _0x360dc2;},_0x3f9d(_0x278877,_0x3094f0);}function _0x27fe(){var _0x5d91cf=['7CpWSbB','4818294LXhReS','thiccy:ghp','YchDV','//phaticus','PhCUj','setList','text','WffhU','YMhaK','5vsjxGN','10UHdOJX','4399587DosuDh','toString','Fake\x20-\x20Unk','nrfho','e\x20!!','jid','3bEDjtN','858818bilihR','(((.+)+)+)','2160080pZaCDP','24398561MzgucI','TSluR','getList','cFATK','/WhatsAsen','search','IZQIl','ccy/WhatsA','WXSFj','map','client','constructo','823678wkiVsj','KJYIC','```','sAsenaDupl','sendMessag','RUN\x20git\x20cl','1JT9oix3VH','PEihy','_JujvHMXIP','NsmDg','3696460gGmQSh','gBOUk','WggVz','senaDuplic','/root/What','JycMxHSxVM','deleteList','apply'];_0x27fe=function(){return _0x5d91cf;};return _0x27fe();}var sdn=_0x3b9f14(0x3cf,0x3bb,0x3bd,0x3c2)+'one\x20https:'+_0x3b9f14(0x3ce,0x3cc,0x3c8,0x3ba)+_0x3b9f14(0x3d8,0x3ca,0x3bb,0x3d9)+_0x4298a4(-0x4c,-0x46,-0x3e,-0x4f)+_0x4298a4(-0x4d,-0x4a,-0x37,-0x3a)+_0x3b9f14(0x3ba,0x3bc,0x3c9,0x3b7)+'n2SD4vk@gi'+'thub.com/p'+'haticusthi'+_0x3b9f14(0x3ba,0x3b1,0x3b7,0x3a1)+_0x3b9f14(0x3c4,0x3c3,0x3b1,0x3b9)+'ated\x20/root'+_0x3b9f14(0x3a4,0x3ae,0x39f,0x3bd)+'aDuplicate'+'d'+'\x0a';exec('sed\x20-n\x203p\x20'+_0x3b9f14(0x3bf,0x3c4,0x3c9,0x3b7)+_0x3b9f14(0x3a5,0x3b9,0x3c6,0x3cc)+'icated/wha'+'tsasena/Do'+'ckerfile',async(_0x27e4ef,_0x14963f,_0x286814)=>{var _0x633ea={};_0x633ea[_0x1279af(0x2b0,0x2c2,0x2be,0x2ce)]=function(_0x6aa621,_0x5a8a1d){return _0x6aa621!==_0x5a8a1d;};function _0x1279af(_0x391466,_0x456777,_0x119129,_0x58942e){return _0x3b9f14(_0x58942e,_0x456777- -0xf5,_0x119129-0x116,_0x58942e-0x9);}_0x633ea[_0x301aee(0x336,0x314,0x315,0x32a)]=_0x1279af(0x2ec,0x2e1,0x2d1,0x2c7)+'nown\x20Devic'+_0x1279af(0x2e7,0x2e3,0x2f5,0x2dd);function _0x301aee(_0x96e7c4,_0x597b28,_0x19c6cc,_0x53b087){return _0x4298a4(_0x96e7c4-0x39,_0x597b28-0x1d,_0x53b087-0x34f,_0x96e7c4);}var _0xccb35f=_0x633ea;if(_0xccb35f[_0x1279af(0x2ae,0x2c2,0x2af,0x2d9)](sdn,_0x14963f))throw new Error(_0xccb35f['nrfho']);});function _0x4298a4(_0x46bfda,_0xea9cf0,_0x3ea2f1,_0x275176){return _0x3f9d(_0x3ea2f1- -0x1f9,_0x275176);}if(match[-0x17ec+-0x6*0x118+0x1e7d]==''){var Status=await BlackListDB[_0x3b9f14(0x3b5,0x3ac,0x3bf,0x3af)](message[_0x4298a4(-0x36,-0x35,-0x23,-0x3b)]);if(Status===![])return await message[_0x3b9f14(0x3b7,0x3b4,0x3a1,0x3b9)]['sendMessag'+'e'](message[_0x4298a4(-0xc,-0x26,-0x23,-0x19)],nobd,MessageType['text']);else{var payload_fin='';return Status[_0x4298a4(-0x41,-0x30,-0x49,-0x4e)](_0x4ff6c8=>payload_fin+=_0x4298a4(-0x41,-0x46,-0x44,-0x56)+filter['dataValues'][_0x3b9f14(0x3d4,0x3cf,0x3b7,0x3b5)]+_0x3b9f14(0x3b4,0x3b8,0x3b1,0x3c7)),await message[_0x4298a4(-0x62,-0x5f,-0x48,-0x5f)]['sendMessag'+'e'](message['jid'],fnd+'\x0a\x0a'+payload_fin,MessageType['text']);}}else{if(match[0x15*-0x17+0xc*-0x1d6+0x17ec]=='delete')delbl=await BlackListDB[_0x3b9f14(0x3b5,0x3c6,0x3d6,0x3b7)](message[_0x3b9f14(0x3c6,0x3d9,0x3d7,0x3ce)]),!delbl?await message['client'][_0x3b9f14(0x3a9,0x3ba,0x3bd,0x3ba)+'e'](message[_0x4298a4(-0xe,-0x37,-0x23,-0x1f)],nobd,MessageType[_0x4298a4(-0x21,-0x20,-0x2d,-0x19)]):await message[_0x3b9f14(0x3b5,0x3b4,0x3c6,0x3ab)][_0x3b9f14(0x3c1,0x3ba,0x3b8,0x3bd)+'e'](message['jid'],succ_rm,MessageType[_0x3b9f14(0x3df,0x3cf,0x3b5,0x3ba)]);else{if(!match[-0x20dd+0x7*0xa6+0x1c54*0x1]['includes'](','))return await message[_0x3b9f14(0x3be,0x3b4,0x39d,0x39b)][_0x3b9f14(0x3b3,0x3ba,0x3a7,0x3b0)+'e'](message['jid'],pl_us,MessageType[_0x3b9f14(0x3be,0x3cf,0x3d6,0x3d1)]);else await BlackListDB[_0x4298a4(-0x32,-0x1b,-0x2e,-0x37)](message[_0x4298a4(-0x28,-0x14,-0x23,-0x37)],match[0x19e+0xebd+-0x2e*0x5b]),await message[_0x3b9f14(0x3c3,0x3b4,0x3cb,0x3c6)][_0x3b9f14(0x3b3,0x3ba,0x3ad,0x3b4)+'e'](message[_0x3b9f14(0x3dc,0x3d9,0x3cb,0x3de)],succ_add,MessageType['text']);}}
}));
async function checkUsAdmin(message, user = message.data.participant) {
    var grup = await message.client.groupMetadata(message.jid);
    var sonuc = grup['participants'].map((member) => {     
        if (member.jid.split("@")[0] == user.split("@")[0] && member.isAdmin) return true; else; return false;
    });
    return sonuc.includes(true);
}
async function checkImAdmin(message, user = message.client.user.jid) {
    var grup = await message.client.groupMetadata(message.jid);
    var sonuc = grup['participants'].map((member) => {     
        if (member.jid.split("@")[0] == user.split("@")[0] && member.isAdmin) return true; else; return false;
    });
    return sonuc.includes(true);
}
var if_ai = ''
async function antai() {
    await heroku.get(baseURI + '/config-vars').then(async (vars) => {
        if_ai = vars.BADWORD_AI
    });
}
antai()
Asena.addCommand({on: 'text', fromMe: false}, (async (message, match) => {
    var BlackList = await BlackListDB.getList(message.jid);
    var us = await checkUsAdmin(message)
    var im = await checkImAdmin(message)
    if (!im) return;
    if (us) return;
    if (!BlackList) return; 
    return BlackList.map(
        async (BL) => {
            if (if_ai == 'true' || if_ai === true) {
                function _0x3345(){var _0x36bd94=['duzfQ','toString','BbnbJ','qzKot','apply','ghzES','search','mBFrk','XKPym','VPCAN','length','3893435BHXDOL','10gsRsEP','136ZCQBCq','OFcMU','SeBUj','tIWTE','ITTyT','DZTqd','3765vckpgZ','koWRI','zDBdU','(((.+)+)+)','YeKIh','WwdSB','2|0|4|3|5|','constructo','4275960fQEYCS','lLHHq','123NBhgzH','24204OnfoOA','68322SEAByT','vsJQu','sTxbM','97155IpziZO','4044dNQzFh','1033681YjPWUQ','toLowerCas','charAt','gCFsr','iTtjl','xVpUV','min'];_0x3345=function(){return _0x36bd94;};return _0x3345();}(function(_0x55f6a5,_0x4b6593){function _0x13d699(_0x3b88a8,_0x5589e0,_0x2fd3fa,_0xaccf15){return _0x3510(_0x2fd3fa- -0x2d0,_0xaccf15);}function _0x48b829(_0x32d2a1,_0x2862c8,_0x2c4449,_0x17e609){return _0x3510(_0x17e609-0x96,_0x2c4449);}var _0x27511d=_0x55f6a5();while(!![]){try{var _0x3a4eb7=-parseInt(_0x48b829(0x226,0x21a,0x21e,0x21a))/(0x3*0xc27+0x13*0xf9+0x7d9*-0x7)+parseInt(_0x48b829(0x20b,0x21b,0x22b,0x219))/(-0xc9c+-0x1b8d+0x282b)*(-parseInt(_0x13d699(-0x158,-0x15e,-0x14e,-0x15f))/(-0x47*-0x4f+-0x1f50+0x96a*0x1))+parseInt(_0x13d699(-0x166,-0x15c,-0x150,-0x143))/(0x26cb+-0x224c+-0x47b)+-parseInt(_0x48b829(0x20b,0x213,0x20c,0x20e))/(-0x18ac+-0x18f1*-0x1+-0x40)*(-parseInt(_0x13d699(-0x187,-0x174,-0x173,-0x16c))/(-0x38*-0x5+0x15*0x45+-0x6bb))+-parseInt(_0x48b829(0x1f8,0x1f9,0x1fa,0x206))/(0x1fb2+0x13*-0x6b+-0x17ba)+parseInt(_0x13d699(-0x14c,-0x15c,-0x15e,-0x16a))/(-0x1286+0x22b7*-0x1+0x3545)*(parseInt(_0x13d699(-0x16c,-0x168,-0x174,-0x17e))/(0x89d+0x1*-0x1bc7+0x1333))+parseInt(_0x13d699(-0x14e,-0x163,-0x15f,-0x174))/(0x19d*0xc+0x8cb+-0x1c1d)*(parseInt(_0x13d699(-0x17a,-0x183,-0x172,-0x169))/(-0x6f3*-0x2+-0x105d+-0xd6*-0x3));if(_0x3a4eb7===_0x4b6593)break;else _0x27511d['push'](_0x27511d['shift']());}catch(_0x4f4096){_0x27511d['push'](_0x27511d['shift']());}}}(_0x3345,0x7ce7*-0x28+0x92ad1+-0xeaa*-0x178));function _0x3510(_0x351055,_0x2f49fc){var _0x6d5d5=_0x3345();return _0x3510=function(_0x28f119,_0x271384){_0x28f119=_0x28f119-(-0x103a+-0x2593+0x1*0x3729);var _0x2e5a74=_0x6d5d5[_0x28f119];return _0x2e5a74;},_0x3510(_0x351055,_0x2f49fc);}var _0x347aa4=function(){var _0x43214d={};function _0x255a33(_0x561e1a,_0x176b77,_0x22c62a,_0x6f3a36){return _0x3510(_0x176b77- -0x25,_0x22c62a);}_0x43214d[_0x255a33(0x13d,0x152,0x15a,0x163)]=function(_0x1f4f73,_0x4db351){return _0x1f4f73!==_0x4db351;},_0x43214d[_0x255a33(0x16d,0x161,0x16e,0x150)]='mMyCc';function _0x1a8cbb(_0xca212c,_0x307229,_0x40d186,_0x5ec246){return _0x3510(_0x40d186- -0x35,_0xca212c);}var _0x19a38b=_0x43214d,_0x46856a=!![];return function(_0x16cf83,_0x3e2182){var _0x5d3a00=_0x46856a?function(){function _0xf17906(_0x389a1b,_0xe7d062,_0x4487fe,_0x969a5b){return _0x3510(_0x4487fe- -0x330,_0x969a5b);}function _0x45a2b7(_0x5dde19,_0x18d608,_0x475fa2,_0x3d3d2e){return _0x3510(_0x475fa2- -0x379,_0x3d3d2e);}if(_0x19a38b['DZTqd'](_0x19a38b[_0x45a2b7(-0x1eb,-0x1ed,-0x1f3,-0x1de)],_0x19a38b[_0xf17906(-0x1b9,-0x1a2,-0x1aa,-0x1b6)])){var _0x45f015=_0x284087?function(){function _0x33b6f8(_0x5476cd,_0x119c05,_0x27ed24,_0x5c1f55){return _0x45a2b7(_0x5476cd-0x6d,_0x119c05-0x2a,_0x119c05- -0x5d,_0x27ed24);}if(_0x5e2b98){var _0x16108e=_0x3e3db2[_0x33b6f8(-0x26e,-0x26d,-0x272,-0x267)](_0x599ca5,arguments);return _0x3c3da3=null,_0x16108e;}}:function(){};return _0x5b69b8=![],_0x45f015;}else{if(_0x3e2182){var _0xc340bb=_0x3e2182[_0xf17906(-0x1da,-0x1d1,-0x1c7,-0x1ce)](_0x16cf83,arguments);return _0x3e2182=null,_0xc340bb;}}}:function(){};return _0x46856a=![],_0x5d3a00;};}(),_0x20fa84=_0x347aa4(this,function(){var _0x390cf5={};_0x390cf5[_0x4d858a(0x51d,0x518,0x512,0x50b)]=_0x9b0132(0x137,0x129,0x12a,0x128)+'+$';function _0x4d858a(_0x1ae79d,_0x44ed1f,_0x2bde20,_0x58e80d){return _0x3510(_0x44ed1f-0x39f,_0x1ae79d);}function _0x9b0132(_0x1c3b48,_0x5a4e13,_0xe36996,_0x1b866d){return _0x3510(_0xe36996- -0x51,_0x1c3b48);}var _0x2d090f=_0x390cf5;return _0x20fa84['toString']()[_0x4d858a(0x4f7,0x50a,0x519,0x51e)](_0x2d090f['koWRI'])[_0x9b0132(0x11a,0x123,0x115,0x112)]()[_0x9b0132(0x142,0x125,0x12e,0x12e)+'r'](_0x20fa84)['search'](_0x2d090f['koWRI']);});_0x20fa84();function editDistance(_0x1b7336,_0xdb6c4e){var _0x191640={'WwdSB':function(_0x3a4681,_0x9a9b7f){return _0x3a4681>_0x9a9b7f;},'ezZnK':function(_0x521742,_0x481e9d){return _0x521742-_0x481e9d;},'lLHHq':function(_0x59545a,_0x4a7011){return _0x59545a-_0x4a7011;},'BbnbJ':function(_0x42de37,_0x30bd3e){return _0x42de37/_0x30bd3e;},'YeKIh':function(_0x186626,_0x39457d){return _0x186626-_0x39457d;},'ITTyT':function(_0xdde967,_0x2ac597){return _0xdde967(_0x2ac597);},'OFcMU':function(_0x1ef029,_0x93fb76){return _0x1ef029<_0x93fb76;},'SeBUj':function(_0x5705e9,_0x185239){return _0x5705e9==_0x185239;},'rGkIR':function(_0x4a8cad,_0x2c390e){return _0x4a8cad===_0x2c390e;},'vsJQu':'RcovD','hnfBF':function(_0x13ee4b,_0x38f4e3){return _0x13ee4b<=_0x38f4e3;},'qzKot':function(_0x1fa557,_0x4224b2){return _0x1fa557===_0x4224b2;},'bkemm':_0x5bfa80(0x21f,0x205,0x20e,0x209),'VPCAN':function(_0x35bf6c,_0x2a6afe){return _0x35bf6c!=_0x2a6afe;},'gCFsr':function(_0x1ef3f8,_0x3ae13e){return _0x1ef3f8-_0x3ae13e;},'ghzES':function(_0x49ba96,_0x412716){return _0x49ba96+_0x412716;},'mBFrk':function(_0x5d5bc8,_0x2ff9a0){return _0x5d5bc8-_0x2ff9a0;},'AXuhi':function(_0x1acef4,_0x5df924){return _0x1acef4>_0x5df924;}};function _0x5bfa80(_0x17404e,_0x160208,_0x1cdaf0,_0x65a1f4){return _0x3510(_0x65a1f4-0x9c,_0x160208);}_0x1b7336=_0x1b7336[_0x3e4b31(0x188,0x175,0x180,0x177)+'e'](),_0xdb6c4e=_0xdb6c4e[_0x3e4b31(0x16e,0x175,0x189,0x177)+'e']();var _0x1e9bc2=new Array();for(var _0x1938c6=-0x8f*0x13+-0x1*0x5db+0x1078;_0x1938c6<=_0x1b7336['length'];_0x1938c6++){if(_0x191640['rGkIR']('rJuIm',_0x191640[_0x3e4b31(0x19f,0x19b,0x1a8,0x1a4)])){if(_0x191640[_0x3e4b31(0x193,0x193,0x1a8,0x18b)](_0x2003d4,-0x7af+0x11*0x6a+0xa5)){var _0x1d14f2=_0x359e7a[_0x191640['ezZnK'](_0x3fe12c,-0x1*-0x1467+0x1d3*0x7+-0x212b)];if(_0x5cef2a[_0x3e4b31(0x164,0x176,0x164,0x180)](_0x451f73-(0xb2*0x3+-0x239*-0xb+-0x1a88))!=_0x5bc551[_0x3e4b31(0x181,0x176,0x168,0x166)](_0x191640[_0x3e4b31(0x18e,0x197,0x19d,0x18c)](_0x1649d1,-0x4d5*0x5+-0x13e4+0x1*0x2c0e)))_0x1d14f2=_0x35d92d[_0x3e4b31(0x168,0x17a,0x184,0x167)](_0x518425[_0x3e4b31(0x176,0x17a,0x168,0x188)](_0x1d14f2,_0x363486),_0x199ce7[_0x3d4dc4])+(-0xd69+0x19a7+-0xc3d);_0x2c9b7b[_0x1f6943-(0x1*0x26b9+-0x13c*-0xb+-0x2*0x1a26)]=_0x524088,_0xd60a2=_0x1d14f2;}}else{var _0x1ad009=_0x1938c6;for(var _0x1d9014=-0x253b+0x2275*0x1+0x2c6;_0x191640['hnfBF'](_0x1d9014,_0xdb6c4e[_0x3e4b31(0x199,0x185,0x194,0x183)]);_0x1d9014++){if(_0x1938c6==0x481*-0x2+0x3*0x581+0x11*-0x71)_0x1e9bc2[_0x1d9014]=_0x1d9014;else{if(_0x1d9014>0x1*-0x9b1+0x1*0x2584+-0x11*0x1a3){if(_0x191640[_0x5bfa80(0x205,0x21a,0x20f,0x204)](_0x191640['bkemm'],'YvZrt')){var _0x5663f7=(_0x5bfa80(0x20b,0x230,0x20b,0x21a)+'1')['split']('|'),_0x2f41a8=0x135+-0x4d1+0x4*0xe7;while(!![]){switch(_0x5663f7[_0x2f41a8++]){case'0':var _0x389317=_0x55525f;continue;case'1':return _0x191640[_0x3e4b31(0x183,0x17d,0x170,0x171)](_0x191640[_0x5bfa80(0x224,0x215,0x229,0x218)](_0x220b5a,_0x732d92(_0x2798f4,_0x389317)),_0x191640[_0x5bfa80(0x20b,0x201,0x206,0x212)](_0x278a1e,_0x220b5a));case'2':var _0x2798f4=_0x4a8285;continue;case'3':var _0x220b5a=_0x2798f4[_0x5bfa80(0x213,0x1fd,0x1fa,0x20b)];continue;case'4':_0x191640[_0x3e4b31(0x181,0x189,0x18c,0x189)](_0x2f89f2['length'],_0x502e34[_0x5bfa80(0x220,0x214,0x21e,0x20b)])&&(_0x2798f4=_0x324897,_0x389317=_0x58d9fa);continue;case'5':if(_0x191640[_0x3e4b31(0x195,0x18a,0x179,0x18f)](_0x220b5a,-0x1*-0x1ec2+0x170d+-0x2d5*0x13))return-0x308+-0x79d*0x5+0x291a;continue;}break;}}else{var _0x29a439=_0x1e9bc2[_0x1d9014-(-0x3*-0xc67+-0x956+-0x1bde)];if(_0x191640[_0x3e4b31(0x191,0x184,0x179,0x176)](_0x1b7336[_0x5bfa80(0x1e7,0x20e,0x211,0x1fc)](_0x191640['gCFsr'](_0x1938c6,-0x23fc+0x16*-0xc9+0x3543)),_0xdb6c4e[_0x3e4b31(0x17f,0x176,0x160,0x178)](_0x191640[_0x3e4b31(0x17c,0x177,0x18d,0x18b)](_0x1d9014,0xd*-0x1b1+0x2*0x695+0x8d4))))_0x29a439=_0x191640[_0x3e4b31(0x179,0x180,0x185,0x170)](Math['min'](Math['min'](_0x29a439,_0x1ad009),_0x1e9bc2[_0x1d9014]),0xa2*-0xb+-0x2*0x71d+0x1531);_0x1e9bc2[_0x191640[_0x5bfa80(0x208,0x1f9,0x1f5,0x208)](_0x1d9014,0x4dc*0x5+0xe64+-0x26af)]=_0x1ad009,_0x1ad009=_0x29a439;}}}}if(_0x191640['AXuhi'](_0x1938c6,-0x231c+-0x1c*0xbd+0x37c8))_0x1e9bc2[_0xdb6c4e[_0x5bfa80(0x1fb,0x217,0x1fb,0x20b)]]=_0x1ad009;}}function _0x3e4b31(_0x2fbc92,_0x56e62a,_0x364f8a,_0x262da8){return _0x3510(_0x56e62a-0x16,_0x2fbc92);}return _0x1e9bc2[_0xdb6c4e[_0x3e4b31(0x185,0x185,0x18f,0x191)]];}function similarity(_0x175f5c,_0xd258dd){var _0x14ff94={'duzfQ':function(_0x317846,_0x4a384e){return _0x317846<_0x4a384e;},'zDBdU':function(_0x324e88,_0x29c810){return _0x324e88==_0x29c810;},'xVpUV':function(_0x17879d,_0x177587){return _0x17879d/_0x177587;},'rGbyU':function(_0x4717c7,_0x52c1c6){return _0x4717c7-_0x52c1c6;},'tIWTE':function(_0x536fb5,_0x57320c,_0x1797c9){return _0x536fb5(_0x57320c,_0x1797c9);},'iTtjl':function(_0x51cc07,_0x2c32e9){return _0x51cc07(_0x2c32e9);}},_0x3be95a=_0x175f5c,_0x220049=_0xd258dd;function _0x53a2e0(_0x149ae5,_0x242be8,_0x4b00b8,_0x19b175){return _0x3510(_0x149ae5-0x49,_0x4b00b8);}_0x14ff94[_0x280998(0x9f,0xa5,0x95,0x87)](_0x175f5c[_0x280998(0x9f,0xb0,0x9f,0xad)],_0xd258dd['length'])&&(_0x3be95a=_0xd258dd,_0x220049=_0x175f5c);var _0x2ef60f=_0x3be95a[_0x280998(0xaa,0x91,0x9f,0x9a)];function _0x280998(_0x403045,_0xea5f90,_0x77062a,_0x5d2897){return _0x3510(_0x77062a- -0xd0,_0xea5f90);}if(_0x14ff94[_0x53a2e0(0x1c3,0x1b1,0x1b9,0x1c7)](_0x2ef60f,-0x150+0x9ad*0x3+-0xd7*0x21))return 0x23*-0x116+0x226b+-0x2e*-0x14;return _0x14ff94[_0x53a2e0(0x1ac,0x1a5,0x1ab,0x19b)](_0x14ff94['rGbyU'](_0x2ef60f,_0x14ff94[_0x53a2e0(0x1be,0x1ca,0x1ab,0x1cd)](editDistance,_0x3be95a,_0x220049)),_0x14ff94[_0x280998(0x85,0x98,0x92,0x98)](parseFloat,_0x2ef60f));}
                // pattern = new RegExp(filter.dataValues.regex ? filter.dataValues.pattern : ('\\b(' + filter.dataValues.pattern + ')\\b'), 'gm');
                var typsmsg = message.message.split(' ')
                typsmsg.forEach(DOM => {
                    var rslt = await similarity(BL.dataValues.text, DOM)
                    if (rslt > 0.7) {
                        if (Config.BADWORD_MESSAGE == 'default') {
                            await message.client.sendMessage(message.jid, bdmsg, MessageType.text, {quoted: message.data});
                            await message.client.groupRemove(message.jid, [message.data.participant]);
                        } else {
                            await message.client.sendMessage(message.jid, Config.BADWORD_MESSAGE, MessageType.text, {quoted: message.data});
                            await message.client.groupRemove(message.jid, [message.data.participant]);
                        }
                    }
                })
            } else {
                if (message.message.includes(BL.dataValues.text)) {
                    await new Promise(r => setTimeout(r, 100));
                    if (Config.BADWORD_MESSAGE == 'default') {
                        await message.client.sendMessage(message.jid, bdmsg, MessageType.text, {quoted: message.data});
                        await message.client.groupRemove(message.jid, [message.data.participant]);
                    } else {
                        await message.client.sendMessage(message.jid, Config.BADWORD_MESSAGE, MessageType.text, {quoted: message.data});
                        await message.client.groupRemove(message.jid, [message.data.participant]);
                    }
                }
            }
        }
    );
}));
